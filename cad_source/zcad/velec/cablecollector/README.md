# Модуль сбора кабелей CableCollector

## Назначение

Модуль предназначен для сбора информации о кабельных линиях, их группировки по методам монтажа и отображения суммарных длин в интерфейсе ZcUI.

## Архитектура

Модуль разработан с использованием ООП и разделён на 5 файлов:

### Файлы модуля

1. **uzvcablecollector_types.pas** - Структуры данных
   - `TCableInfo` - информация об отдельном кабеле
   - `TCableGroupInfo` - сгруппированная информация
   - Векторы для хранения данных

2. **uzvcablecollector_utils.pas** - Утилитарные функции
   - Сортировка групп
   - Форматирование длин
   - Создание ключей группировки

3. **uzvcablecollector_ui.pas** - Вывод в интерфейс
   - Константы локализации
   - Функции вывода в ZcUI
   - Форматирование таблиц

4. **uzvcablecollector_core.pas** - Основная логика
   - Класс `TCableCollector`
   - Методы сбора и анализа
   - Управление данными

5. **uzvcablecollector_command.pas** - Регистрация команды
   - Функция команды `CableCollector_Run_com`
   - Регистрация в системе ZCAD

## Использование

### Вызов команды

В консоли ZCAD выполните:
```
CableCollector
```

### Последовательность работы

1. Сбор данных (`Collect`) - обход всех примитивов чертежа
2. Анализ (`Analyze`) - группировка по имени и методу монтажа
3. Вывод (`PrintToZcUI`) - отображение результатов в табличном виде

## Собираемые атрибуты

Из каждого кабельного примитива извлекаются:
- `NMO_Name` - наименование кабеля
- `CABLE_Segment` - номер сегмента
- `CABLE_MountingMethod` - метод монтажа
- `AmountD` - длина кабеля

## Формат вывода

```
[INFO] Сбор данных о кабелях...
[INFO] Обработано 125 примитивов.
[INFO] Анализ по методам монтажа завершён.
-----------------------------------------------------
Имя кабеля              | Метод монтажа   | Суммарная длина
-----------------------------------------------------
NYM 3x2.5               | В лотке         | 134.50
NYM 3x2.5               | В трубе         | 98.20
ВВГнг 4x10              | На лотке        | 75.00
-----------------------------------------------------
[INFO] Завершено успешно.
```

## Возможности расширения

Архитектура модуля позволяет в будущем добавить:
- Экспорт результатов в CSV/XLSX
- Фильтрацию по этажам или сегментам
- Визуализацию в чертеже
- Дополнительную статистику

## Зависимости

- `uzcentcable.pas` - работа с кабельными примитивами
- `uzcdrawings.pas` - доступ к чертежу
- `uzcinterface.pas` - вывод в интерфейс
- `uzcLog.pas` - логирование
- `varmandef.pas` - работа с переменными
- `uzcenitiesvariablesextender.pas` - доступ к атрибутам

## Разработка

Автор: Vladimir Bobrov
Создано: 2025
Лицензия: См. COPYING.txt
