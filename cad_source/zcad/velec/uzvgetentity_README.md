# Модуль uzvgetentity.pas

## Описание

Модуль для фильтрации и получения примитивов типов superline, cable и device из чертежа ZCAD.

## Основная функция

### uzvGetEntity(mode: Integer; param: String): TEntityVector

Функция получения списка отфильтрованных примитивов.

**Параметры:**
- `mode` - режим работы функции (0, 1 или 2)
- `param` - параметр для режима 2 (значение ENTID_Type для фильтрации)

**Возвращаемое значение:**
- `TEntityVector` - вектор с указателями на примитивы типов superline/cable/device

**Режимы работы:**

| Режим | Описание | Параметр param |
|-------|----------|----------------|
| 0 | Собрать все примитивы superline/cable/device со всего чертежа | Не используется |
| 1 | Собрать выделенные примитивы (с запуском выделения при необходимости) | Не используется |
| 2 | Поиск по значению переменной ENTID_Type | Значение ENTID_Type для фильтрации |

## Команда для тестирования

### UzvGetEntity

Команда для тестирования функции `uzvGetEntity` из командной строки ZCAD.

**Синтаксис:**
```
UzvGetEntity [режим] [параметр]
```

**Примеры использования:**

1. Получить все примитивы superline/cable/device со всего чертежа:
   ```
   UzvGetEntity 0
   ```

2. Получить выделенные примитивы:
   ```
   UzvGetEntity 1
   ```

3. Найти примитивы по ENTID_Type:
   ```
   UzvGetEntity 2 "MY_DEVICE_TYPE"
   ```

**Вывод команды:**

Команда выводит:
- Режим работы
- Параметр поиска (для режима 2)
- Количество найденных примитивов
- Детальный список найденных примитивов с указанием типа и значения ENTID_Type

**Пример вывода:**
```
==============================================
Команда: UzvGetEntity - тестирование фильтрации примитивов
==============================================
Режим работы: 0
Сбор всех устройств (superline/cable/device) со всего чертежа…
Найдено объектов: 5
----------------------------------------------
Результаты поиска:
Найдено примитивов: 5
1. Тип: GDBSuperLine, ENTID_Type: "POWER_LINE"
2. Тип: GDBCable, ENTID_Type: "CABLE_1"
3. Тип: GDBDevice, ENTID_Type: "SWITCH"
4. Тип: GDBDevice, ENTID_Type: "LAMP"
5. Тип: GDBSuperLine, ENTID_Type: "SIGNAL_LINE"
==============================================
```

## Вспомогательные функции

### IsValidEntityType(pObj: PGDBObjEntity): Boolean

Проверяет, является ли примитив одним из требуемых типов (superline, cable или device).

### GetEntityIDType(pObj: PGDBObjEntity): String

Получает значение переменной ENTID_Type для примитива.

## Использование в коде

```pascal
uses
  uzvgetentity;

var
  entities: TEntityVector;
  i: Integer;
  pObj: PGDBObjEntity;

// Получить все примитивы
entities := uzvGetEntity(0, '');
try
  for i := 0 to entities.Count - 1 do
  begin
    pObj := entities[i];
    // Обработка примитива
  end;
finally
  entities.Free;
end;

// Поиск по ENTID_Type
entities := uzvGetEntity(2, 'MY_DEVICE_TYPE');
try
  // Обработка найденных примитивов
finally
  entities.Free;
end;
```

## Примечания

- После использования вектора `TEntityVector` необходимо вызвать `Free` для освобождения памяти
- При некорректном режиме (не 0, 1 или 2) функция вернет пустой вектор и выведет сообщение об ошибке
- В режиме 1, если нет выделенных объектов, функция выводит запрос на выделение (TODO: реализация механизма выделения)
