======================================================================
Testing 4 points with degree 3 (cubic)
======================================================================

Input points:
[[0.  0.  0. ]
 [1.  2.  0. ]
 [2.  0.5 0. ]
 [3.  1.5 0. ]]

Parameters (chord length):
[0.         0.41005768 0.74065675 1.        ]

Knot vector (length=8):
[0. 0. 0. 0. 1. 1. 1. 1.]

Building 4x4 basis matrix...

Row 0: u = 0.000000
  N_0,3(0.000000) = 1.000000
  N_1,3(0.000000) = 0.000000
  N_2,3(0.000000) = 0.000000
  N_3,3(0.000000) = 0.000000

Row 1: u = 0.410058
  N_0,3(0.410058) = 0.205319
  N_1,3(0.410058) = 0.428140
  N_2,3(0.410058) = 0.297592
  N_3,3(0.410058) = 0.068950

Row 2: u = 0.740657
  N_0,3(0.740657) = 0.017443
  N_1,3(0.740657) = 0.149447
  N_2,3(0.740657) = 0.426806
  N_3,3(0.740657) = 0.406304

Row 3: u = 1.000000
  N_0,3(1.000000) = 0.000000
  N_1,3(1.000000) = 0.000000
  N_2,3(1.000000) = 0.000000
  N_3,3(1.000000) = 0.000000

Basis matrix:
[[1.         0.         0.         0.        ]
 [0.20531877 0.42813951 0.29759163 0.06895009]
 [0.01744315 0.14944732 0.42680566 0.40630387]
 [0.         0.         0.         0.        ]]

Basis matrix condition number: inf
Basis matrix determinant: 0.000000e+00

❌ PROBLEM: Matrix is singular or nearly singular!
This will cause the solver to fail or give incorrect results.

❌ LINEAR ALGEBRA ERROR: Singular matrix
The system could not be solved!
