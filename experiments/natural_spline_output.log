================================================================================
Testing different parameterizations with natural boundary condition
================================================================================

================================================================================
Parameterization: uniform
================================================================================
Parameters: [0.         0.16666667 0.33333333 0.5        0.66666667 0.83333333
 1.        ]

Number of control points: 9
Knot vector: [0.         0.         0.         0.         0.16666667 0.33333333
 0.5        0.66666667 0.83333333 1.         1.         1.
 1.        ]

Control points:
✓ CP 0: (1583.2137, 417.8366) vs (1583.2137, 417.8366) diff= 0.0001
✗ CP 1: (1959.2508, 560.8500) vs (1943.9619, 588.3078) diff=31.4274
✗ CP 2: (2711.3250, 846.8768) vs (2770.7705, 979.0151) diff=144.8940
✗ CP 3: (1649.8316, 2128.3922) vs (1225.7225, 2260.4551) diff=444.1950
✗ CP 4: (-933.3918, 1273.6536) vs (-771.0874, 1052.6822) diff=274.1735
✗ CP 5: (-274.0276, 3077.5184) vs (-50.7662, 3342.0538) diff=346.1569
✗ CP 6: (1781.8213, 3125.1963) vs (1877.2100, 3020.2007) diff=141.8558
✗ CP 7: (2893.5894, 2472.7893) vs (2911.8082, 2445.3350) diff=32.9494
✓ CP 8: (3449.4735, 2146.5858) vs (3449.4735, 2146.5858) diff= 0.0000

Max diff: 444.1950, Avg diff: 157.2947

================================================================================
Parameterization: chord_length
================================================================================
Parameters: [0.         0.10860267 0.24890938 0.45285361 0.58096864 0.78223565
 1.        ]

Number of control points: 9
Knot vector: [0.         0.         0.         0.         0.10860267 0.24890938
 0.45285361 0.58096864 0.78223565 1.         1.         1.
 1.        ]

Control points:
✓ CP 0: (1583.2137, 417.8366) vs (1583.2137, 417.8366) diff= 0.0001
✓ CP 1: (1943.9619, 588.3078) vs (1943.9619, 588.3078) diff= 0.0000
✓ CP 2: (2770.7705, 979.0151) vs (2770.7705, 979.0151) diff= 0.0000
✓ CP 3: (1225.7225, 2260.4551) vs (1225.7225, 2260.4551) diff= 0.0000
✓ CP 4: (-771.0874, 1052.6822) vs (-771.0874, 1052.6822) diff= 0.0000
✓ CP 5: (-50.7662, 3342.0538) vs (-50.7662, 3342.0538) diff= 0.0000
✓ CP 6: (1877.2100, 3020.2007) vs (1877.2100, 3020.2007) diff= 0.0000
✓ CP 7: (2911.8082, 2445.3350) vs (2911.8082, 2445.3350) diff= 0.0000
✓ CP 8: (3449.4735, 2146.5858) vs (3449.4735, 2146.5858) diff= 0.0000

Max diff: 0.0001, Avg diff: 0.0000

✓✓✓ EXCELLENT MATCH!

================================================================================
Parameterization: centripetal_0.25
================================================================================
Parameters: [0.         0.15070087 0.31136733 0.48778151 0.64483791 0.82067026
 1.        ]

Number of control points: 9
Knot vector: [0.         0.         0.         0.         0.15070087 0.31136733
 0.48778151 0.64483791 0.82067026 1.         1.         1.
 1.        ]

Control points:
✓ CP 0: (1583.2137, 417.8366) vs (1583.2137, 417.8366) diff= 0.0001
✗ CP 1: (1956.5900, 568.9104) vs (1943.9619, 588.3078) diff=23.1458
✗ CP 2: (2728.0335, 881.0481) vs (2770.7705, 979.0151) diff=106.8830
✗ CP 3: (1549.4284, 2158.4862) vs (1225.7225, 2260.4551) diff=339.3865
✗ CP 4: (-878.7039, 1227.1194) vs (-771.0874, 1052.6822) diff=204.9626
✗ CP 5: (-211.4848, 3138.2942) vs (-50.7662, 3342.0538) diff=259.5158
✗ CP 6: (1806.1495, 3104.0240) vs (1877.2100, 3020.2007) diff=109.8906
✗ CP 7: (2898.1145, 2467.8202) vs (2911.8082, 2445.3350) diff=26.3268
✓ CP 8: (3449.4735, 2146.5858) vs (3449.4735, 2146.5858) diff= 0.0000

Max diff: 339.3865, Avg diff: 118.9012

================================================================================
Parameterization: centripetal_0.5
================================================================================
Parameters: [0.         0.13567624 0.28988987 0.47581549 0.62317683 0.80787808
 1.        ]

Number of control points: 9
Knot vector: [0.         0.         0.         0.         0.13567624 0.28988987
 0.47581549 0.62317683 0.80787808 1.         1.         1.
 1.        ]

Control points:
✓ CP 0: (1583.2137, 417.8366) vs (1583.2137, 417.8366) diff= 0.0001
✗ CP 1: (1952.9820, 576.1332) vs (1943.9619, 588.3078) diff=15.1519
✗ CP 2: (2743.0399, 914.3545) vs (2770.7705, 979.0151) diff=70.3561
✗ CP 3: (1446.2299, 2190.5614) vs (1225.7225, 2260.4551) diff=231.3194
✗ CP 4: (-833.8154, 1175.1959) vs (-771.0874, 1052.6822) diff=137.6387
✗ CP 5: (-153.9972, 3202.0793) vs (-50.7662, 3342.0538) diff=173.9238
✗ CP 6: (1830.2603, 3079.7904) vs (1877.2100, 3020.2007) diff=75.8630
✗ CP 7: (2902.6960, 2461.7112) vs (2911.8082, 2445.3350) diff=18.7407
✓ CP 8: (3449.4735, 2146.5858) vs (3449.4735, 2146.5858) diff= 0.0000

Max diff: 231.3194, Avg diff: 80.3326

================================================================================
Parameterization: centripetal_0.75
================================================================================
Parameters: [0.         0.12163523 0.26903196 0.46415681 0.60183941 0.79504001
 1.        ]

Number of control points: 9
Knot vector: [0.         0.         0.         0.         0.12163523 0.26903196
 0.46415681 0.60183941 0.79504001 1.         1.         1.
 1.        ]

Control points:
✓ CP 0: (1583.2137, 417.8366) vs (1583.2137, 417.8366) diff= 0.0001
~ CP 1: (1948.6996, 582.5797) vs (1943.9619, 588.3078) diff= 7.4335
✗ CP 2: (2757.0788, 946.9573) vs (2770.7705, 979.0151) diff=34.8592
✗ CP 3: (1338.8281, 2224.5763) vs (1225.7225, 2260.4551) diff=118.6598
✗ CP 4: (-798.1134, 1117.2807) vs (-771.0874, 1052.6822) diff=70.0240
✗ CP 5: (-100.7037, 3269.7077) vs (-50.7662, 3342.0538) diff=87.9074
✗ CP 6: (1854.0065, 3052.0260) vs (1877.2100, 3020.2007) diff=39.3859
✗ CP 7: (2907.2819, 2454.2838) vs (2911.8082, 2445.3350) diff=10.0284
✓ CP 8: (3449.4735, 2146.5858) vs (3449.4735, 2146.5858) diff= 0.0000

Max diff: 118.6598, Avg diff: 40.9220

================================================================================
BEST RESULT:
================================================================================
Parameterization: chord_length
Maximum error: 0.0001

Parameters: [0.         0.10860267 0.24890938 0.45285361 0.58096864 0.78223565
 1.        ]
Knot vector: [0.         0.         0.         0.         0.10860267 0.24890938
 0.45285361 0.58096864 0.78223565 1.         1.         1.
 1.        ]

Verifying interpolation:
✓ Point 0: diff=0.000000
✓ Point 1: diff=0.000000
✓ Point 2: diff=0.000000
✓ Point 3: diff=0.000000
✓ Point 4: diff=0.000000
✓ Point 5: diff=0.000000
✓ Point 6: diff=0.000000

================================================================================
Fine-tuning centripetal alpha:
================================================================================
alpha=0.905: max_diff=45.7652
alpha=0.953: max_diff=23.0119
alpha=1.000: max_diff=0.0001
