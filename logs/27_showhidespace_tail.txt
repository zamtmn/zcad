          // Check if polyline contains specified variables
          if EntityHasAnyVariable(pEntity, varList) then begin
            // Выделяем полилинию
            // Select the polyline
            //pEntity^.Select(drawings.GetCurrentDWG^.wa.param.SelDesc.Selectedobjcount,
            //               @drawings.GetCurrentDWG^.Selector);
            inc(foundCount);

            // Создаем сплошную штриховку внутри полилинии
            // Create solid hatch inside polyline
            pPolyline := PGDBObjPolyLine(pEntity);
            phatch := CreateSolidHatchFromPolyline(pPolyline, colorIndex, pLayer);

            if phatch <> nil then begin
              // Добавляем штриховку в чертеж
              // Add hatch to drawing
              zcAddEntToCurrentDrawingWithUndo(phatch);
              inc(hatchCount);
            end;
          end;
        end;

        pEntity := drawings.GetCurrentROOT^.ObjArray.iterate(ir);
      until pEntity = nil;

    // Выводим результаты
    // Output results
    zcUI.TextMessage('Обработано примитивов / Entities processed: ' + IntToStr(processedCount), TMWOHistoryOut);
    zcUI.TextMessage('Найдено и выделено полилиний / Polylines found and selected: ' + IntToStr(foundCount), TMWOHistoryOut);
    zcUI.TextMessage('Создано штриховок / Hatches created: ' + IntToStr(hatchCount), TMWOHistoryOut);

    // Перерисовываем для отображения выделения и штриховок
    // Redraw to show selection and hatches
    if foundCount > 0 then
      zcUI.Do_GUIaction(nil, zcMsgUIActionRedraw);

  finally
    varList.Free;
  end;

  Result := cmd_ok;
end;

initialization
  // Регистрация команды ShowHideSpace
  // Register the ShowHideSpace command
  CreateZCADCommand(@ShowHideSpace_com,'ShowHideSpace',CADWG,0);
end.
